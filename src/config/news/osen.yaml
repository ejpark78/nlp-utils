---
jobs:
- article:
    document_id:
      replace:
      - from: /article/
        to: ''
      type: path
  host: https://corpus.ncsoft.com:9200
  http_auth: crawler:crawler2019
  index: crawler-major_press-osen
  list:
  - category: 야구/삼성
    headers:
      Content-Type: application/json
    mapping:
      title: '{TITLE}'
      url: http://osen.mt.co.kr/article/{GISANO}
    parser: json
    trace: rows
    url_frame: http://osen.mt.co.kr/api/probaseball/team_news/lions?offset={page}
  - category: 야구/넥센
    headers:
      Content-Type: application/json
    mapping:
      title: '{TITLE}'
      url: http://osen.mt.co.kr/article/{GISANO}
    parser: json
    trace: rows
    url_frame: http://osen.mt.co.kr/api/probaseball/team_news/heroes?offset={page}
  - category: 야구/NC
    headers:
      Content-Type: application/json
    mapping:
      title: '{TITLE}'
      url: http://osen.mt.co.kr/article/{GISANO}
    parser: json
    trace: rows
    url_frame: http://osen.mt.co.kr/api/probaseball/team_news/dinos?offset={page}
  - category: 야구/LG
    headers:
      Content-Type: application/json
    mapping:
      title: '{TITLE}'
      url: http://osen.mt.co.kr/article/{GISANO}
    parser: json
    trace: rows
    url_frame: http://osen.mt.co.kr/api/probaseball/team_news/twins?offset={page}
  - category: 야구/SK
    headers:
      Content-Type: application/json
    mapping:
      title: '{TITLE}'
      url: http://osen.mt.co.kr/article/{GISANO}
    parser: json
    trace: rows
    url_frame: http://osen.mt.co.kr/api/probaseball/team_news/wyverns?offset={page}
  - category: 야구/두산
    headers:
      Content-Type: application/json
    mapping:
      title: '{TITLE}'
      url: http://osen.mt.co.kr/article/{GISANO}
    parser: json
    trace: rows
    url_frame: http://osen.mt.co.kr/api/probaseball/team_news/bears?offset={page}
  - category: 야구/롯데
    headers:
      Content-Type: application/json
    mapping:
      title: '{TITLE}'
      url: http://osen.mt.co.kr/article/{GISANO}
    parser: json
    trace: rows
    url_frame: http://osen.mt.co.kr/api/probaseball/team_news/giants?offset={page}
  - category: 야구/KIA
    headers:
      Content-Type: application/json
    mapping:
      title: '{TITLE}'
      url: http://osen.mt.co.kr/article/{GISANO}
    parser: json
    trace: rows
    url_frame: http://osen.mt.co.kr/api/probaseball/team_news/tigers?offset={page}
  - category: 야구/한화
    headers:
      Content-Type: application/json
    mapping:
      title: '{TITLE}'
      url: http://osen.mt.co.kr/article/{GISANO}
    parser: json
    trace: rows
    url_frame: http://osen.mt.co.kr/api/probaseball/team_news/eagles?offset={page}
  - category: 야구/KT
    headers:
      Content-Type: application/json
    mapping:
      title: '{TITLE}'
      url: http://osen.mt.co.kr/article/{GISANO}
    parser: json
    trace: rows
    url_frame: http://osen.mt.co.kr/api/probaseball/team_news/wiz?offset={page}
  post_process:
  - module: save_s3
    name: AWS S3 이미지 업로드 설정
    path: osen
    url_prefix: http://paige-cdn.plaync.com
  - exchange:
      name: crawler.paige
      type: topic
    host:
      name: mq_server
      port: 5672
      user_name: user
      user_password: nlplab!
    module: rabbit_mq
    name: RabbitMQ 메세지 전송
    payload:
      elastic:
        host: https://corpus.ncsoft.com:9200
        http_auth: crawler:crawler2019
        index: corpus_process-major_press-osen
      module:
      - column: html_content
        domain: baseball
        name: nlu/POS
        result: pos_tagged
      - column: html_content
        domain: baseball
        name: sp/ne_tagger
        result: named_entity
      - column: html_content
        domain: baseball
        name: nlu/NER
        result: named_entity_v2
      post_mq: true
  sleep: 2
parsing:
  article:
  - comment: 제목
    key: title
    tag:
    - attribute:
        class: detailTitle
      name: div
    - name: h1
    type: text
  - comment: 날짜
    key: date
    tag:
    - attribute:
        class: detailTitle
      name: div
    - attribute:
        class: detailTitle__post-infos
      name: div
    type: text
    type_convert: date
    value_type: single
  - comment: html 본문
    key: html_content
    remove:
    - name: iframe
    - name: script
    - attribute:
        class: news-copyright
      name: div
    - attribute:
        class: realtime-session
      name: div
    - attribute:
        id: taboola-organic-below-article-thumbnails
      name: div
    - attribute:
        id: taboola-below-article-thumbnails
      name: div
    - attribute:
        id: divBox
      name: div
    - attribute:
        class: content-inner__banner
      name: div
    tag:
    - attribute:
        class: detailView
      name: div
    type: html
    value_type: merge
  - comment: 이미지
    delete: true
    key: image_list.image
    tag:
    - attribute:
        class: view_photo up
      name: img
    type: src
  - comment: 텍스트 본문
    key: content
    tag:
    - attribute:
        class: detailView
      name: div
    type: text
    value_type: merge
  descriptions:
    article: 기사 본문에서 추출해야하는 tag 정보
    list: 기사 목록에서 추출해야하는 하나의 기사 정보
    trace: 전체 html 에서 추출해야하는 전체 tag 목록
  list: {}
  parser: html5lib
  trace: {}
