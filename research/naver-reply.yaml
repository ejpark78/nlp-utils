image: registry.nlp-utils/crawler:live

imagePullSecrets: registry

restartPolicy: Never

resources:
  requests:
    cpu: 100m
    memory: 100Mi
  limits:
    cpu: 100m
    memory: 100Mi

hostAliases:
  - ip: "172.20.93.112"
    hostnames:
      - "corpus.ncsoft.com"

environmentVariables:
  - name: ELASTIC_SEARCH_AUTH
    valueFrom:
      secretKeyRef:
        name: elasticsearch-auth
        key: http_auth

schedule:
  concurrencyPolicy: Forbid
  failedJobsHistoryLimit: 1
  successfulJobsHistoryLimit: 1

jobs:
  - name: naver-reply-politics
    schedule: "0 * * * *"
    environmentVariables:
      - name: ELASTIC_SEARCH_INDEX
        value: $(INDEX_POLITICS)
    configMapRef: naver-reply
    args:
      - "python3"
      - "-m"
      - "crawler.naver.reply"
      - "--config"
      - "/config/naver/politics-reply.yaml"
      - "--sleep"
      - "20"

  - name: naver-reply-society
    schedule: "5 * * * *"
    environmentVariables:
      - name: ELASTIC_SEARCH_INDEX
        value: $(INDEX_SOCIETY)
    configMapRef: naver-reply
    args:
      - "python3"
      - "-m"
      - "crawler.naver.reply"
      - "--config"
      - "/config/naver/society-reply.yaml"
      - "--sleep"
      - "20"

  - name: naver-reply-tv
    schedule: "10 * * * *"
    environmentVariables:
      - name: ELASTIC_SEARCH_INDEX
        value: $(INDEX_TV)
    configMapRef: naver-reply
    args:
      - "python3"
      - "-m"
      - "crawler.naver.reply"
      - "--config"
      - "/config/naver/tv-reply.yaml"
      - "--sleep"
      - "20"

  - name: naver-reply-economy
    schedule: "15 * * * *"
    environmentVariables:
      - name: ELASTIC_SEARCH_INDEX
        value: $(INDEX_ECONOMY)
    configMapRef: naver-reply
    args:
      - "python3"
      - "-m"
      - "crawler.naver.reply"
      - "--config"
      - "/config/naver/economy-reply.yaml"
      - "--sleep"
      - "20"

  - name: naver-reply-international
    schedule: "20 * * * *"
    environmentVariables:
      - name: ELASTIC_SEARCH_INDEX
        value: $(INDEX_INTERNATIONAL)
    configMapRef: naver-reply
    args:
      - "python3"
      - "-m"
      - "crawler.naver.reply"
      - "--config"
      - "/config/naver/international-reply.yaml"
      - "--sleep"
      - "20"

  - name: naver-reply-it
    schedule: "25 * * * *"
    environmentVariables:
      - name: ELASTIC_SEARCH_INDEX
        value: $(INDEX_IT)
    configMapRef: naver-reply
    args:
      - "python3"
      - "-m"
      - "crawler.naver.reply"
      - "--config"
      - "/config/naver/it-reply.yaml"
      - "--sleep"
      - "20"

  - name: naver-reply-living
    schedule: "30 * * * *"
    environmentVariables:
      - name: ELASTIC_SEARCH_INDEX
        value: $(INDEX_LIVING)
    configMapRef: naver-reply
    args:
      - "python3"
      - "-m"
      - "crawler.naver.reply"
      - "--config"
      - "/config/naver/living-reply.yaml"
      - "--sleep"
      - "20"

  - name: naver-reply-opinion
    schedule: "35 * * * *"
    environmentVariables:
      - name: ELASTIC_SEARCH_INDEX
        value: $(INDEX_OPINION)
    configMapRef: naver-reply
    args:
      - "python3"
      - "-m"
      - "crawler.naver.reply"
      - "--config"
      - "/config/naver/opinion-reply.yaml"
      - "--sleep"
      - "20"

  - name: naver-reply-sports
    schedule: "40 * * * *"
    environmentVariables:
      - name: ELASTIC_SEARCH_INDEX
        value: $(INDEX_SPORTS)
    configMapRef: naver-reply
    args:
      - "python3"
      - "-m"
      - "crawler.naver.reply"
      - "--config"
      - "/config/naver/sports-reply.yaml"
      - "--sleep"
      - "20"

